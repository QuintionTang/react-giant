$(function () {
    "use strict";
    $(window).on("load", function () {
        // 1. preloader
        $("#preloader").fadeOut(600);
        $(".preloader-bg").delay(400).fadeOut(600);

        // 2. fadeIn.element
        setTimeout(function () {
            $(".fadeIn-element")
                .delay(600)
                .css({
                    display: "none",
                })
                .fadeIn(800);
        }, 0);
    });

    // 2. navigation
    $("body").scrollspy({
        target: ".navbar-fixed-top",
    });
    $(".navbar-collapse ul li a").on("click", function () {
        $(".navbar-toggle:visible").click();
    });
    $(window).on("scroll", function () {
        if ($(".navbar").offset().top > 50) {
            $(".navbar-bg-switch").addClass("main-navigation-bg");
            $(".navbar-bg-switch-bordered").addClass(
                "main-navigation-bg-bordered"
            );
        } else {
            $(".navbar-bg-switch").removeClass("main-navigation-bg");
            $(".navbar-bg-switch-bordered").removeClass(
                "main-navigation-bg-bordered"
            );
        }

        // 5. to top arrow animation
        if ($(this).scrollTop() > 400) {
            $(".to-top-arrow").addClass("show");
        } else {
            $(".to-top-arrow").removeClass("show");
        }
    });

    // 3. newsletter form
    $("form#subscribe").on("submit", function () {
        var elemErrors = $(" .subscribe-error");
        elemErrors.html("");
        var s = !1;
        if (
            ($(".subscribe-requiredField").each(function () {
                if ("" === jQuery.trim($(this).val())) {
                    $(this).prev("label").text(),
                        elemErrors.html("<span>Please enter your Email</span>"),
                        $(this).addClass("inputError"),
                        (s = !0);
                    return false;
                } else if ($(this).hasClass("subscribe-email")) {
                    var r = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
                    r.test(jQuery.trim($(this).val())) ||
                        ($(this).prev("label").text(),
                        elemErrors.html(
                            "<span >Please enter a valid Email</span>"
                        ),
                        $(this).addClass("inputError"),
                        (s = !0));
                    return false;
                }
            }),
            !s)
        ) {
            $("form#subscribe input.submit").fadeOut("normal", function () {
                $(this).parent().append("");
            });
            var r = $(this).serialize();
            $.post($(this).attr("action"), r, function () {
                $("form#subscribe").slideUp("fast", function () {
                    $(this).before(
                        '<div class="subscribe-success">Thank you for subscribing.</div>'
                    );
                });
            });
        }
        return !1;
    });

    // 4. home fadeOut animation
    $(window).on("scroll", function () {
        $("h1.home-page-title, .home-page-subtitle-carousel").css(
            "opacity",
            1 -
                $(window).scrollTop() /
                    $(".hero-fullscreen, #viewport").height()
        );
    });
});
